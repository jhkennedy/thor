function [ K ] = watsonK( e )
% [K]=watsonK( e ) estimates the concentration parameter for the
% Watson distribution from the appropriate eigenvalue, e, of the
% orientation tensor.
%   
%   e is a 3x1 array of the eigenvalues of the orientation tensor, arranged
%   such that e1 > e2 > e3;
%
% K is the concentration parameter for the Watson distribution to second
% decimal place precision. Positive values specify girdle type
%   distributions, negative values specify single maximum type
%   distributions, and K=0 specifies a uniform distribution. All these
%   distributions are  specified around a primary axis. K will be a scalar
%   value. 

    % make sure e is arranged properly
    e = sort(e,'descend');
    
    % get interpolation table
    T = table();
    
    % find which distribution type
    if e(1) == 1/3 % isotropic
        
        K = 0;
        
    elseif e(1) >= .999 % perfect bipolar
        
        K = -inf;
        
    elseif e(3) <= .001 % perfect girdle
        
        K = inf;
    
    elseif e(1)/e(2) > e(2)/e(3) % e2 'small' so bipolar
       
        K = interp1(T(:,1),T(:,2),e(1));
        
    else % e2 'large' so girdle
        
        K = interp1(T(:,1),T(:,2),e(3));
        
    end


end

function [T] = table()

% table from page 386 of Direction Statistics by Kanti V. Mardia. 2000.
% ISBN: 0-471-95333-4
    % e*, K
T = [0.001,0500.000;...
     0.005,0100.000;...
     0.010,0050.000;...
     0.015,0033.333;...
     0.020,0025.000;...
     0.025,0020.000;...
     0.030,0016.667;...
     0.035,0014.290;...
     0.040,0012.250;...
     0.045,0011.110;...
     0.050,0009.992;...
     0.055,0009.087;...
     0.060,0008.327;...
     0.065,0007.681;...
     0.070,0007.126;...
     0.075,0006.641;...
     0.080,0006.215;...
     0.085,0005.836;...
     0.090,0005.495;...
     0.095,0005.188;...
     0.100,0004.908;...
     0.105,0004.651;...
     0.110,0004.415;...
     0.115,0004.196;...
     0.120,0003.993;...
     0.125,0003.802;...
     0.130,0003.624;...
     0.135,0003.457;...
     0.140,0003.298;...
     0.145,0003.148;...
     0.150,0003.006;...
     0.155,0002.870;...
     0.160,0002.741;...
     0.165,0002.617;...
     0.170,0002.499;...
     0.175,0002.385;...
     0.180,0002.275;...
     0.185,0002.170;...
     0.190,0002.068;...
     0.195,0001.970;...
     0.200,0001.874;...
     0.205,0001.782;...
     0.210,0001.692;...
     0.215,0001.605;...
     0.220,0001.520;...
     0.225,0001.438;...
     0.230,0001.357;...
     0.235,0001.279;...
     0.240,0001.202;...
     0.245,0001.127;...
     0.250,0001.053;...
     0.255,0000.982;...
     0.260,0000.911;...
     0.265,0000.842;...
     0.270,0000.774;...
     0.275,0000.708;...
     0.280,0000.642;...
     0.285,0000.578;...
     0.290,0000.514;...
     0.295,0000.452;...
     0.300,0000.390;...
     0.305,0000.330;...
     0.310,0000.270;...
     0.315,0000.211;...
     0.320,0000.152;...
     0.325,0000.095;...
     0.330,0000.038;...
     0.333,0000.004;...
     0.340,-0000.075;...
     0.350,-0000.184;...
     0.360,-0000.292;...
     0.370,-0000.398;...
     0.380,-0000.503;...
     0.390,-0000.606;...
     0.400,-0000.708;...
     0.410,-0000.809;...
     0.420,-0000.909;...
     0.430,-0001.008;...
     0.440,-0001.106;...
     0.450,-0001.204;...
     0.460,-0001.302;...
     0.470,-0001.399;...
     0.480,-0001.497;...
     0.490,-0001.594;...
     0.500,-0001.692;...
     0.510,-0001.790;...
     0.520,-0001.888;...
     0.530,-0001.987;...
     0.540,-0002.087;...
     0.550,-0002.188;...
     0.560,-0002.289;...
     0.570,-0002.392;...
     0.580,-0002.496;...
     0.590,-0002.602;...
     0.600,-0002.709;...
     0.610,-0002.819;...
     0.620,-0002.930;...
     0.630,-0003.044;...
     0.640,-0003.160;...
     0.650,-0003.280;...
     0.660,-0003.402;...
     0.670,-0003.529;...
     0.680,-0003.659;...
     0.690,-0003.764;...
     0.700,-0003.934;...
     0.710,-0004.079;...
     0.720,-0004.231;...
     0.730,-0004.389;...
     0.740,-0004.556;...
     0.750,-0004.731;...
     0.760,-0004.917;...
     0.770,-0005.115;...
     0.780,-0005.323;...
     0.790,-0005.552;...
     0.800,-0005.797;...
     0.810,-0006.063;...
     0.820,-0006.354;...
     0.830,-0006.676;...
     0.840,-0007.035;...
     0.850,-0007.438;...
     0.860,-0007.897;...
     0.870,-0008.426;...
     0.880,-0009.043;...
     0.890,-0009.776;...
     0.900,-0010.654;...
     0.910,-0011.746;...
     0.920,-0013.112;...
     0.930,-0014.878;...
     0.940,-0017.242;...
     0.950,-0020.560;...
     0.960,-0025.546;...
     0.970,-0033.866;...
     0.980,-0050.521;...
     0.990,-0100.510;...
     0.995,-0200.500;...
     0.999,-1000.500];

end



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% FEvoR: Fabric Evolution with Recrystallization %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Copyright (C) 2009-2014  Joseph H Kennedy
%
% This file is part of FEvoR.
%
% FEvoR is free software: you can redistribute it and/or modify it under the 
% terms of the GNU General Public License as published by the Free Software 
% Foundation, either version 3 of the License, or (at your option) any later 
% version.
%
% FEvoR is distributed in the hope that it will be useful, but WITHOUT ANY 
% WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS 
% FOR A PARTICULAR PURPOSE.  See the GNU General Public License for more 
% details.
%
% You should have received a copy of the GNU General Public License along 
% with FEvoR.  If not, see <http://www.gnu.org/licenses/>.
%
% Additional permission under GNU GPL version 3 section 7
%
% If you modify FEvoR, or any covered work, to interface with
% other modules (such as MATLAB code and MEX-files) available in a
% MATLAB(R) or comparable environment containing parts covered
% under other licensing terms, the licensors of FEvoR grant
% you additional permission to convey the resulting work.


